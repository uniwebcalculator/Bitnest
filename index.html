<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Earning Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #2563eb;
      --accent: #06b6d4;
      --bg: #f9fafb;
      --text: #111827;
      --text-light: #374151;
      --border: #e5e7eb;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 16px;
    }
    .container { max-width: 900px; margin: auto; }
    h1 { text-align: center; font-size: 1.4rem; font-weight: 600; margin-bottom: 16px; color: var(--primary); }
    .form-grid { display: grid; gap: 8px; margin-bottom: 20px; }
    .form-row { display: flex; align-items: center; justify-content: space-between; }
    .form-row label { font-size: 0.85rem; font-weight: 500; color: var(--text-light); margin-right: 8px; flex: 1; }
    .form-row input { flex: 1.2; padding: 6px 8px; border: 1px solid var(--border); border-radius: 6px; font-size: 0.85rem; }
    .results h2, .cycle h2 { font-size: 1rem; font-weight: 600; margin: 12px 0 8px; color: var(--primary); }
    .section-title { font-size: 0.8rem; font-weight: 600; margin: 10px 0 4px; color: var(--text-light); border-left: 3px solid var(--accent); padding-left: 6px; }
    .result-row { display: flex; justify-content: space-between; font-size: 0.8rem; padding: 2px 0; }
    .total { font-weight: 600; font-size: 0.9rem; text-align: center; margin-top: 12px; color: var(--primary); }
    table { width: 100%; border-collapse: collapse; font-size: 0.75rem; margin-top: 10px; }
    th, td { border: 1px solid var(--border); padding: 4px; text-align: right; }
    th { background: #f3f4f6; color: var(--text-light); font-weight: 600; }
    td:first-child, th:first-child { text-align: center; }
    tr:nth-child(even) { background: #f9fafb; }
  </style>
</head>
<body>
  <div class="container">
    <h1>BitNest Calculator</h1>
    <div class="form-grid">
      <div class="form-row"><label for="cycles">Cycles</label><input type="number" id="cycles" value="1" min="1"></div>
      <div class="form-row"><label for="initiator">Initiator</label><input type="number" id="initiator" value="0" min="0"></div>
      <div class="form-row"><label for="l1">Level 1</label><input type="number" id="l1" value="0" min="0"></div>
      <div class="form-row"><label for="l2">Level 2</label><input type="number" id="l2" value="0" min="0"></div>
      <div class="form-row"><label for="l3">Level 3</label><input type="number" id="l3" value="0" min="0"></div>
    </div>

    <div class="results" id="results"></div>
    <div class="cycle" id="cycleTable"></div>
  </div>

  <script>
    const roiRate = 0.24;

    function calculate() {
      let cycles = Number(document.getElementById("cycles").value);
      cycles = Math.max(1, cycles); // Ensure at least 1 cycle

      let initiator = Number(document.getElementById("initiator").value);
      let l1 = Number(document.getElementById("l1").value);
      let l2 = Number(document.getElementById("l2").value);
      let l3 = Number(document.getElementById("l3").value);

      // Arrays to track cycle history
      let iniHistory = [], l1History = [], l2History = [], l3History = [], netHistory = [];

      // Track cumulative ROI and referral for summary
      let iniROI = 0, iniRef = 0;
      let l1ROI = 0, l1Ref = 0;
      let l2ROI = 0, l2Ref = 0;
      let l3ROI = 0, l3Ref = 0;

      for (let i = 1; i <= cycles; i++) {
        // Calculate ROI for this cycle
        const iniProfit = initiator * roiRate;
        const l1Profit = l1 * roiRate;
        const l2Profit = l2 * roiRate;
        const l3Profit = l3 * roiRate;

        // Calculate referral earnings for this cycle
        const iniRefEarn = 0.2*l1Profit + 0.1*l2Profit + 0.05*l3Profit;
        const l1RefEarn = 0.2*l2Profit + 0.1*l3Profit;
        const l2RefEarn = 0.2*l3Profit;
        const l3RefEarn = 0;

        // Add to cumulative totals
        iniROI += iniProfit; iniRef += iniRefEarn;
        l1ROI += l1Profit;   l1Ref += l1RefEarn;
        l2ROI += l2Profit;   l2Ref += l2RefEarn;
        l3ROI += l3Profit;   l3Ref += l3RefEarn;

        // Update balances with ROI + referral
        initiator += iniProfit + iniRefEarn;
        l1 += l1Profit + l1RefEarn;
        l2 += l2Profit + l2RefEarn;
        l3 += l3Profit + l3RefEarn;

        const network = initiator + l1 + l2 + l3;

        // Push current cycle totals
        iniHistory.push(initiator);
        l1History.push(l1);
        l2History.push(l2);
        l3History.push(l3);
        netHistory.push(network);
      }

      // Detailed summary
      document.getElementById("results").innerHTML = `
        <h2>Summary after ${cycles} cycles</h2>

        <div class="section-title">Initiator</div>
        <div class="result-row"><span>ROI Earned</span><span>${iniROI.toFixed(2)}</span></div>
        <div class="result-row"><span>Referral Earned</span><span>${iniRef.toFixed(2)}</span></div>
        <div class="result-row"><span>Total Balance</span><span>${initiator.toFixed(2)}</span></div>

        <div class="section-title">Level 1</div>
        <div class="result-row"><span>ROI Earned</span><span>${l1ROI.toFixed(2)}</span></div>
        <div class="result-row"><span>Referral Earned</span><span>${l1Ref.toFixed(2)}</span></div>
        <div class="result-row"><span>Total Balance</span><span>${l1.toFixed(2)}</span></div>

        <div class="section-title">Level 2</div>
        <div class="result-row"><span>ROI Earned</span><span>${l2ROI.toFixed(2)}</span></div>
        <div class="result-row"><span>Referral Earned</span><span>${l2Ref.toFixed(2)}</span></div>
        <div class="result-row"><span>Total Balance</span><span>${l2.toFixed(2)}</span></div>

        <div class="section-title">Level 3</div>
        <div class="result-row"><span>ROI Earned</span><span>${l3ROI.toFixed(2)}</span></div>
        <div class="result-row"><span>Referral Earned</span><span>${l3Ref.toFixed(2)}</span></div>
        <div class="result-row"><span>Total Balance</span><span>${l3.toFixed(2)}</span></div>

        <div class="total">Network Total: ${netHistory[netHistory.length-1].toFixed(2)}</div>
      `;

      // Cycle-by-cycle table
      let tableHTML = `<h2>Cycle by Cycle</h2>
        <table>
          <tr><th>Cycle</th><th>Initiator</th><th>L1</th><th>L2</th><th>L3</th><th>Network</th></tr>`;
      for (let i = 0; i < cycles; i++) {
        const iniVal = iniHistory[i] ?? 0;
        const l1Val = l1History[i] ?? 0;
        const l2Val = l2History[i] ?? 0;
        const l3Val = l3History[i] ?? 0;
        const netVal = netHistory[i] ?? 0;

        tableHTML += `<tr>
          <td>${i+1}</td>
          <td>${iniVal.toFixed(2)}</td>
          <td>${l1Val.toFixed(2)}</td>
          <td>${l2Val.toFixed(2)}</td>
          <td>${l3Val.toFixed(2)}</td>
          <td>${netVal.toFixed(2)}</td>
        </tr>`;
      }
      tableHTML += "</table>";
      document.getElementById("cycleTable").innerHTML = tableHTML;
    }

    // Event listeners
    document.querySelectorAll("input").forEach(el => el.addEventListener("input", calculate));
    calculate();
  </script>
</body>
</html>