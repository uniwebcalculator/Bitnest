<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Earning Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #2563eb;
  --accent: #06b6d4;
  --bg: #f9fafb;
  --text: #111827;
  --text-light: #374151;
  --border: #e5e7eb;
}
body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin:0; padding:16px; }
.container { max-width: 1000px; margin:auto; }
h1 { text-align:center; font-size:1.4rem; font-weight:600; margin-bottom:16px; color: var(--primary); }
.form-grid { display:grid; gap:8px; margin-bottom:20px; }
.form-row { display:flex; align-items:center; justify-content:space-between; }
.form-row label { font-size:0.85rem; font-weight:500; color: var(--text-light); margin-right:8px; flex:1; }
.form-row input { flex:1.2; padding:6px 8px; border:1px solid var(--border); border-radius:6px; font-size:0.85rem; }

/* Tabs */
.tabs { display:flex; border-bottom:2px solid var(--border); margin-bottom:12px; position:sticky; top:0; background:var(--bg); z-index:10; }
.tab-btn { flex:1; padding:10px; text-align:center; font-size:0.9rem; font-weight:600; cursor:pointer; background:none; border:none; outline:none; }
.tab-btn.active { border-bottom:3px solid var(--primary); color:var(--primary); }

/* Content */
.tab-content { display:none; }
.tab-content.active { display:block; }

.results h2, .cycle h2 { font-size:1rem; font-weight:600; margin:12px 0 8px; color: var(--primary); }
.section-title { font-size:0.8rem; font-weight:600; margin:10px 0 4px; color:var(--text-light); border-left:3px solid var(--accent); padding-left:6px; }
.result-row { display:flex; justify-content:space-between; font-size:0.8rem; padding:2px 0; }
.total { font-weight:600; font-size:0.9rem; text-align:center; margin-top:12px; color: var(--primary); }

/* Table */
table { width:100%; border-collapse:collapse; font-size:0.75rem; margin-top:10px; }
th, td { border:1px solid var(--border); padding:4px; text-align:right; }
th { background:#f3f4f6; color: var(--text-light); font-weight:600; }
td:first-child, th:first-child { text-align:center; }
tr:nth-child(even) { background:#f9fafb; }
small { color:var(--text-light); font-size:0.7rem; }

/* Column group colors */
th.initiator, td.initiator { background:#e0f2fe; }
th.l1, td.l1 { background:#dcfce7; }
th.l2, td.l2 { background:#fef9c3; }
th.l3, td.l3 { background:#fce7f3; }

.download-btn { margin:8px 0; padding:6px 10px; font-size:0.8rem; background:var(--primary); color:white; border:none; border-radius:6px; cursor:pointer; }
</style>
</head>
<body>
<div class="container">
<h1>Earning Calculator</h1>

<div class="form-grid">
  <div class="form-row"><label for="cycles">Cycles</label><input type="number" id="cycles" value="1" min="1"></div>
  <div class="form-row"><label for="initiator">Initiator</label><input type="number" id="initiator" value="100" min="0"></div>
  <div class="form-row"><label for="l1">Level 1</label><input type="number" id="l1" value="50" min="0"></div>
  <div class="form-row"><label for="l2">Level 2</label><input type="number" id="l2" value="25" min="0"></div>
  <div class="form-row"><label for="l3">Level 3</label><input type="number" id="l3" value="10" min="0"></div>
</div>

<div class="tabs">
  <button class="tab-btn active" data-tab="summary">Summary</button>
  <button class="tab-btn" data-tab="cycleDetails">Cycle Details</button>
</div>

<div id="summary" class="tab-content active"></div>
<div id="cycleDetails" class="tab-content"></div>
</div>

<script>
const ROI_RATE=0.24;

document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById(btn.dataset.tab).classList.add('active');
  });
});

function calculate(){
  let cycles=Number(document.getElementById("cycles").value);
  let initiator=Number(document.getElementById("initiator").value);
  let l1=Number(document.getElementById("l1").value);
  let l2=Number(document.getElementById("l2").value);
  let l3=Number(document.getElementById("l3").value);

  const startIni=initiator, startL1=l1, startL2=l2, startL3=l3;
  let iniROI=0, iniRef=0, l1ROI=0, l1Ref=0, l2ROI=0, l2Ref=0, l3ROI=0, l3Ref=0;
  let cycleRows="", csvRows=[["Cycle","Ini Profit","Ini Ref","Ini Total","L1 Profit","L1 Ref","L1 Total","L2 Profit","L2 Ref","L2 Total","L3 Profit","L3 Ref","L3 Total","Network"]];

  for(let i=1;i<=cycles;i++){
    const iniProfit=initiator*ROI_RATE;
    const l1Profit=l1*ROI_RATE;
    const l2Profit=l2*ROI_RATE;
    const l3Profit=l3*ROI_RATE;

    const iniRefEarn=0.2*l1Profit+0.1*l2Profit+0.05*l3Profit;
    const l1RefEarn=0.2*l2Profit+0.1*l3Profit;
    const l2RefEarn=0.2*l3Profit;
    const l3RefEarn=0;

    iniROI+=iniProfit; iniRef+=iniRefEarn;
    l1ROI+=l1Profit; l1Ref+=l1RefEarn;
    l2ROI+=l2Profit; l2Ref+=l2RefEarn;
    l3ROI+=l3Profit; l3Ref+=l3RefEarn;

    initiator+=iniProfit+iniRefEarn;
    l1+=l1Profit+l1RefEarn;
    l2+=l2Profit+l2RefEarn;
    l3+=l3Profit+l3RefEarn;

    const net=initiator+l1+l2+l3;
    const iniPct=startIni>0?((initiator/startIni-1)*100):0;
    const l1Pct=startL1>0?((l1/startL1-1)*100):0;
    const l2Pct=startL2>0?((l2/startL2-1)*100):0;
    const l3Pct=startL3>0?((l3/startL3-1)*100):0;

    cycleRows+=`
      <tr>
        <td>${i}</td>
        <td class="initiator">${iniProfit.toFixed(2)}<br><small>+${iniRefEarn.toFixed(2)}</small></td>
        <td class="initiator">${initiator.toFixed(2)}<br><small>${iniPct.toFixed(1)}%</small></td>
        <td class="l1">${l1Profit.toFixed(2)}<br><small>+${l1RefEarn.toFixed(2)}</small></td>
        <td class="l1">${l1.toFixed(2)}<br><small>${l1Pct.toFixed(1)}%</small></td>
        <td class="l2">${l2Profit.toFixed(2)}<br><small>+${l2RefEarn.toFixed(2)}</small></td>
        <td class="l2">${l2.toFixed(2)}<br><small>${l2Pct.toFixed(1)}%</small></td>
        <td class="l3">${l3Profit.toFixed(2)}<br><small>+${l3RefEarn.toFixed(2)}</small></td>
        <td class="l3">${l3.toFixed(2)}<br><small>${l3Pct.toFixed(1)}%</small></td>
        <td>${net.toFixed(2)}</td>
      </tr>`;

    csvRows.push([i,iniProfit.toFixed(2),iniRefEarn.toFixed(2),initiator.toFixed(2),
      l1Profit.toFixed(2),l1RefEarn.toFixed(2),l1.toFixed(2),
      l2Profit.toFixed(2),l2RefEarn.toFixed(2),l2.toFixed(2),
      l3Profit.toFixed(2),l3RefEarn.toFixed(2),l3.toFixed(2),
      net.toFixed(2)]);
  }

  document.getElementById("summary").innerHTML=`
    <h2>Summary after ${cycles} cycles</h2>
    ${makeSummary("Initiator",startIni,iniROI,iniRef,initiator)}
    ${makeSummary("Level 1",startL1,l1ROI,l1Ref,l1)}
    ${makeSummary("Level 2",startL2,l2ROI,l2Ref,l2)}
    ${makeSummary("Level 3",startL3,l3ROI,l3Ref,l3)}
    <div class="total">Network Total: ${(initiator+l1+l2+l3).toFixed(2)}</div>
  `;

  document.getElementById("cycleDetails").innerHTML=`
    <h2>Cycle by Cycle</h2>
    <button class="download-btn" onclick='downloadCSV(${JSON.stringify(csvRows)})'>Download CSV</button>
    <div style="overflow-x:auto">
      <table>
        <thead>
          <tr>
            <th rowspan="2">Cycle</th>
            <th class="initiator" colspan="2">Initiator</th>
            <th class="l1" colspan="2">Level 1</th>
            <th class="l2" colspan="2">Level 2</th>
            <th class="l3" colspan="2">Level 3</th>
            <th rowspan="2">Network</th>
          </tr>
          <tr>
            <th class="initiator">Profit+Ref</th><th class="initiator">Total</th>
            <th class="l1">Profit+Ref</th><th class="l1">Total</th>
            <th class="l2">Profit+Ref</th><th class="l2">Total</th>
            <th class="l3">Profit+Ref</th><th class="l3">Total</th>
          </tr>
        </thead>
        <tbody>${cycleRows}</tbody>
      </table>
    </div>`;
}

function makeSummary(title,start,roi,ref,final){
  const growthPct=start>0?((final/start-1)*100).toFixed(1):"0";
  return `<div class="section-title">${title}</div>
    <div class="result-row"><span>Initial Investment</span><span>${start.toFixed(2)}</span></div>
    <div class="result-row"><span>ROI Earned</span><span>${roi.toFixed(2)}</span></div>
    <div class="result-row"><span>Referral Earned</span><span>${ref.toFixed(2)}</span></div>
    <div class="result-row"><span>Total Earnings</span><span>${(roi+ref).toFixed(2)}</span></div>
    <div class="result-row"><span>Final Balance</span><span>${final.toFixed(2)}</span></div>
    <div class="result-row"><span>Growth %</span><span>${growthPct}%</span></div>`;
}

function downloadCSV(rows){
  let csvContent=rows.map(e=>e.join(",")).join("\n");
  const blob=new Blob([csvContent],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const link=document.createElement("a");
  link.setAttribute("href",url);
  link.setAttribute("download","earnings.csv");
  link.style.display="none";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Auto-calculate on input change
document.querySelectorAll('input').forEach(input=>input.addEventListener('input', calculate));
calculate();
</script>
</body>
</html>